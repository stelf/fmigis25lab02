# Схема на базата

вж [schema.mermaid.md]

# Задача 2: Анализ на осветлението на пътната мрежа

## Условие
Изчислете процента на пътища (`osi_ulici_26_osm`), които са оборудвани с улично осветление (`ul_osvetlenie`), ако приемем, че една лампа осветява област с радиус от 30 метра. 

Групирайте резултатите по район. 

За всеки район определете:
1. Общата дължина на пътищата в метри
2. Дължината на осветените участъци в метри
3. Процент на осветеност

## Използвани таблици
- `osi_ulici_26_osm` - информация за пътищата
  - `id`: уникален идентификатор
  - `geom`: геометрия на пътя (линия)
  - `name`: име на пътя
  - `type`: тип на пътя

- `ul_osvetlenie` - информация за уличното осветление
  - `id`: уникален идентификатор
  - `geom`: геометрия на осветлението (точка)
  - `lighttype`: тип на осветлението
  - `condition`: състояние на осветлението (много добро, отлично, добро)

- `adm_rayoni` - административно деление на районите
  - `id`: уникален идентификатор
  - `geom`: геометрия на района (полигон)
  - `obns_cyr`: име на района на кирилица

## Решение

Решението включва следните стъпки:

1. Създаване на буфер около уличните лампи в добро състояние
2. Групиране на лампите по район
3. Изчисляване на пресечните отсечки между пътищата и буферите на лампите
4. Изчисляване на дължината на осветените участъци (от т.3)
5. Обобщаване (сумиране) на резултатите по район

## Оптимизации на заявката
За да постигнем по-добра производителност, са приложени следните оптимизации:

1. Използване на `MATERIALIZED` за всички CTE изрази
2. Използване на пространствени индекси с оптимизирани параметри

## Очакван резултат
Таблица, съдържаща:
- Име на района
- Обща дължина на пътищата в метри
- Осветена дължина в метри
- Процент на осветеност

